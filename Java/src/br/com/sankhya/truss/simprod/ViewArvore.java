package br.com.sankhya.truss.simprod;

public class ViewArvore {
	
	
	public static String getQueryArvoreProduto() {
		return "SELECT V.* \r\n"
				+ "FROM \r\n"
				+ "(\r\n"
				+ "\r\n"
				+ "-- NÍVEL 1\r\n"
				+ "SELECT DISTINCT\r\n"
				+ "LMP.CODPRODPA AS CODPRODPRINC,\r\n"
				+ "LMP.CODPRODPA, \r\n"
				+ "LMP.CODPRODMP,\r\n"
				+ "LMP.QTDMISTURA,\r\n"
				+ "LMP.CODVOL,\r\n"
				+ "PRO.USOPROD,\r\n"
				+ "PRC.CODPRC, \r\n"
				+ "PRC.VERSAO,\r\n"
				+ "1 AS NIVEL\r\n"
				+ "\r\n"
				+ "FROM TPRLPA LPA\r\n"
				+ "JOIN TPRPRC PRC ON PRC.IDPROC = LPA.IDPROC AND PRC.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP ON LMP.CODPRODPA = LPA.CODPRODPA\r\n"
				+ "JOIN TGFPRO PRO ON PRO.CODPROD = LMP.CODPRODMP AND LMP.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP.CODPRODPA)\r\n"
				+ "\r\n"
				+ "\r\n"
				+ "\r\n"
				+ "UNION ALL\r\n"
				+ "\r\n"
				+ "-- NÍVEL 2\r\n"
				+ "SELECT DISTINCT\r\n"
				+ "\r\n"
				+ "LMP.CODPRODPA AS CODPRODPRINC, \r\n"
				+ "LMP2.CODPRODPA,\r\n"
				+ "LMP2.CODPRODMP,\r\n"
				+ "LMP2.QTDMISTURA,\r\n"
				+ "LMP2.CODVOL,\r\n"
				+ "PRO2.USOPROD,\r\n"
				+ "PRC2.CODPRC, \r\n"
				+ "PRC2.VERSAO,\r\n"
				+ "2 AS NIVEL\r\n"
				+ "\r\n"
				+ "FROM TPRLPA LPA\r\n"
				+ "JOIN TPRPRC PRC ON PRC.IDPROC = LPA.IDPROC AND PRC.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP ON LMP.CODPRODPA = LPA.CODPRODPA AND LMP.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO ON PRO.CODPROD = LMP.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA2 ON LPA2.CODPRODPA = LMP.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC2 ON PRC2.IDPROC = LPA2.IDPROC AND PRC2.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC2.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP2 ON LMP2.CODPRODPA = LPA2.CODPRODPA AND LMP2.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP2.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO2 ON PRO2.CODPROD = LMP2.CODPRODMP\r\n"
				+ "\r\n"
				+ "\r\n"
				+ "\r\n"
				+ "UNION ALL\r\n"
				+ "\r\n"
				+ "-- NÍVEL 3\r\n"
				+ "SELECT DISTINCT\r\n"
				+ "\r\n"
				+ "LMP.CODPRODPA AS CODPRODPRINC, \r\n"
				+ "LMP3.CODPRODPA,\r\n"
				+ "LMP3.CODPRODMP,\r\n"
				+ "LMP3.QTDMISTURA,\r\n"
				+ "LMP3.CODVOL,\r\n"
				+ "PRO3.USOPROD,\r\n"
				+ "PRC3.CODPRC, \r\n"
				+ "PRC3.VERSAO,\r\n"
				+ "3 AS NIVEL\r\n"
				+ "\r\n"
				+ "FROM TPRLPA LPA\r\n"
				+ "JOIN TPRPRC PRC ON PRC.IDPROC = LPA.IDPROC AND PRC.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP ON LMP.CODPRODPA = LPA.CODPRODPA AND LMP.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO ON PRO.CODPROD = LMP.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA2 ON LPA2.CODPRODPA = LMP.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC2 ON PRC2.IDPROC = LPA2.IDPROC AND PRC2.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC2.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP2 ON LMP2.CODPRODPA = LPA2.CODPRODPA AND LMP2.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP2.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO2 ON PRO2.CODPROD = LMP2.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA3 ON LPA3.CODPRODPA = LMP2.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC3 ON PRC3.IDPROC = LPA3.IDPROC AND PRC3.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC3.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP3 ON LMP3.CODPRODPA = LPA3.CODPRODPA AND LMP3.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP3.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO3 ON PRO3.CODPROD = LMP3.CODPRODMP\r\n"
				+ "\r\n"
				+ "\r\n"
				+ "UNION ALL\r\n"
				+ "\r\n"
				+ "-- NÍVEL 4\r\n"
				+ "SELECT DISTINCT\r\n"
				+ "\r\n"
				+ "LMP.CODPRODPA AS CODPRODPRINC, \r\n"
				+ "LMP4.CODPRODPA,\r\n"
				+ "LMP4.CODPRODMP,\r\n"
				+ "LMP4.QTDMISTURA,\r\n"
				+ "LMP4.CODVOL,\r\n"
				+ "PRO4.USOPROD,\r\n"
				+ "PRC4.CODPRC, \r\n"
				+ "PRC4.VERSAO,\r\n"
				+ "4 AS NIVEL\r\n"
				+ "\r\n"
				+ "FROM TPRLPA LPA\r\n"
				+ "JOIN TPRPRC PRC ON PRC.IDPROC = LPA.IDPROC AND PRC.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP ON LMP.CODPRODPA = LPA.CODPRODPA AND LMP.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO ON PRO.CODPROD = LMP.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA2 ON LPA2.CODPRODPA = LMP.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC2 ON PRC2.IDPROC = LPA2.IDPROC AND PRC2.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC2.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP2 ON LMP2.CODPRODPA = LPA2.CODPRODPA AND LMP2.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP2.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO2 ON PRO2.CODPROD = LMP2.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA3 ON LPA3.CODPRODPA = LMP2.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC3 ON PRC3.IDPROC = LPA3.IDPROC AND PRC3.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC3.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP3 ON LMP3.CODPRODPA = LPA3.CODPRODPA AND LMP3.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP3.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO3 ON PRO3.CODPROD = LMP3.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA4 ON LPA4.CODPRODPA = LMP3.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC4 ON PRC4.IDPROC = LPA4.IDPROC AND PRC4.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC4.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP4 ON LMP4.CODPRODPA = LPA4.CODPRODPA AND LMP4.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP4.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO4 ON PRO4.CODPROD = LMP4.CODPRODMP\r\n"
				+ "\r\n"
				+ "\r\n"
				+ "UNION ALL \r\n"
				+ "\r\n"
				+ "-- NÍVEL 5\r\n"
				+ "SELECT DISTINCT\r\n"
				+ "\r\n"
				+ "LMP.CODPRODPA AS CODPRODPRINC, \r\n"
				+ "LMP5.CODPRODPA,\r\n"
				+ "LMP5.CODPRODMP,\r\n"
				+ "LMP5.QTDMISTURA,\r\n"
				+ "LMP5.CODVOL,\r\n"
				+ "PRO5.USOPROD,\r\n"
				+ "PRC5.CODPRC, \r\n"
				+ "PRC5.VERSAO,\r\n"
				+ "5 AS NIVEL\r\n"
				+ "\r\n"
				+ "FROM TPRLPA LPA\r\n"
				+ "JOIN TPRPRC PRC ON PRC.IDPROC = LPA.IDPROC AND PRC.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP ON LMP.CODPRODPA = LPA.CODPRODPA AND LMP.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO ON PRO.CODPROD = LMP.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA2 ON LPA2.CODPRODPA = LMP.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC2 ON PRC2.IDPROC = LPA2.IDPROC AND PRC2.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC2.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP2 ON LMP2.CODPRODPA = LPA2.CODPRODPA AND LMP2.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP2.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO2 ON PRO2.CODPROD = LMP2.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA3 ON LPA3.CODPRODPA = LMP2.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC3 ON PRC3.IDPROC = LPA3.IDPROC AND PRC3.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC3.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP3 ON LMP3.CODPRODPA = LPA3.CODPRODPA AND LMP3.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP3.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO3 ON PRO3.CODPROD = LMP3.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA4 ON LPA4.CODPRODPA = LMP3.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC4 ON PRC4.IDPROC = LPA4.IDPROC AND PRC4.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC4.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP4 ON LMP4.CODPRODPA = LPA4.CODPRODPA AND LMP4.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP4.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO4 ON PRO4.CODPROD = LMP4.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA5 ON LPA5.CODPRODPA = LMP4.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC5 ON PRC5.IDPROC = LPA5.IDPROC AND PRC5.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC5.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP5 ON LMP5.CODPRODPA = LPA5.CODPRODPA AND LMP5.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP5.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO5 ON PRO5.CODPROD = LMP5.CODPRODMP\r\n"
				+ "\r\n"
				+ "\r\n"
				+ "UNION ALL\r\n"
				+ "\r\n"
				+ "-- NÍVEL 6\r\n"
				+ "SELECT DISTINCT\r\n"
				+ "\r\n"
				+ "LMP.CODPRODPA AS CODPRODPRINC, \r\n"
				+ "LMP6.CODPRODPA,\r\n"
				+ "LMP6.CODPRODMP,\r\n"
				+ "LMP6.QTDMISTURA,\r\n"
				+ "LMP6.CODVOL,\r\n"
				+ "PRO6.USOPROD,\r\n"
				+ "PRC6.CODPRC, \r\n"
				+ "PRC6.VERSAO,\r\n"
				+ "6 AS NIVEL\r\n"
				+ "\r\n"
				+ "FROM TPRLPA LPA\r\n"
				+ "JOIN TPRPRC PRC ON PRC.IDPROC = LPA.IDPROC AND PRC.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP ON LMP.CODPRODPA = LPA.CODPRODPA AND LMP.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO ON PRO.CODPROD = LMP.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA2 ON LPA2.CODPRODPA = LMP.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC2 ON PRC2.IDPROC = LPA2.IDPROC AND PRC2.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC2.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP2 ON LMP2.CODPRODPA = LPA2.CODPRODPA AND LMP2.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP2.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO2 ON PRO2.CODPROD = LMP2.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA3 ON LPA3.CODPRODPA = LMP2.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC3 ON PRC3.IDPROC = LPA3.IDPROC AND PRC3.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC3.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP3 ON LMP3.CODPRODPA = LPA3.CODPRODPA AND LMP3.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP3.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO3 ON PRO3.CODPROD = LMP3.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA4 ON LPA4.CODPRODPA = LMP3.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC4 ON PRC4.IDPROC = LPA4.IDPROC AND PRC4.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC4.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP4 ON LMP4.CODPRODPA = LPA4.CODPRODPA AND LMP4.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP4.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO4 ON PRO4.CODPROD = LMP4.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA5 ON LPA5.CODPRODPA = LMP4.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC5 ON PRC5.IDPROC = LPA5.IDPROC AND PRC5.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC5.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP5 ON LMP5.CODPRODPA = LPA5.CODPRODPA AND LMP5.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP5.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO5 ON PRO5.CODPROD = LMP5.CODPRODMP\r\n"
				+ "\r\n"
				+ "JOIN TPRLPA LPA6 ON LPA6.CODPRODPA = LMP5.CODPRODMP\r\n"
				+ "JOIN TPRPRC PRC6 ON PRC6.IDPROC = LPA6.IDPROC AND PRC6.IDPROC = (SELECT MAX(IDPROC) FROM TPRPRC P WHERE P.CODPRC = PRC6.CODPRC)\r\n"
				+ "JOIN TPRLMP LMP6 ON LMP6.CODPRODPA = LPA6.CODPRODPA AND LMP6.IDEFX = (SELECT MAX(L.IDEFX) FROM TPRLMP L WHERE L.CODPRODPA = LMP6.CODPRODPA)\r\n"
				+ "JOIN TGFPRO PRO6 ON PRO6.CODPROD = LMP6.CODPRODMP\r\n"
				+ "\r\n"
				+ ") V\r\n"
				+ "ORDER BY V.NIVEL\r\n"
				+ "";
	}
}
